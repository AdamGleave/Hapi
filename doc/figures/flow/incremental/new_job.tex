%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[nodes={font=\bf\small}, scale=0.65]
%  \draw [help lines] (-1,-1) grid (8,5);o

\tikzstyle{tasknode}=[%
  draw,
  circle,
  minimum width=0.4,
  inner sep=0.5mm,
]

% T_0,0
\node [tasknode, green] (t00) at (0,6.5) {T$_0^0$};
% T_0,1
\node [tasknode, green] (t01) at (0,4.5) {T$_1^0$};

% T_1,0
\node [tasknode, green] (t10) at (0,1.5) {T$_0^1$};

% X
\node [draw, rectangle, brown] (x) at (5.0,3.5) {X};

% M_0 & M_1
\node [draw, rectangle, blue] (m0) at (10.0,6.5) {M$_0$};
\node [draw, rectangle, blue] (m1) at (10.0,4.5) {M$_1$};
\node [draw, rectangle, blue] (m2) at (10.0,2.5) {M$_2$};

% sink
\node [draw, regular polygon, regular polygon sides=6] (s) at (12, 3.5) {S};

% U_0
\node [draw, rectangle, red] (u0) at (6.0,7.5) {U$^0$};
% U_1
\node [draw, rectangle, red] (u1) at (6.0,0.5) {U$^1$};

% Tasks to X
\path [draw, ->] (t00) -- node[above, sloped] {3} (x);
\path [draw, ->] (t01) -- node[below, sloped] {3} (x);
\path [draw, ->, red] (t10) -- node[below, sloped] {2} (x);

% Tasks to U_i
\path [draw, ->] (t00) -- node[above, sloped] {10} (u0);
\path [draw, ->] (t01) -- node[above, sloped] {10} (u0);
\path [draw, ->] (t10) -- node[below, sloped] {5} (u1);

% X to machines
\path [draw, ->] (x) -- node[below, sloped] {} (m0);
\path [draw, ->] (x) -- node[below, sloped] {} (m1);
\path [draw, ->, red] (x) -- node[below, sloped] {} (m2);

% Machines to sink
\path [draw, ->, red] (m0) -- node[above, sloped, red] {} (s);
\path [draw, ->, red] (m1) -- node[below, sloped, red] {} (s);
\path [draw, ->, red] (m2) -- node[below, sloped] {} (s);

% U_i to sink
\begin{scope}[decoration={post length=4pt},rounded corners=4mm]
  \path [draw, ->] (u0) -- ++(1.5,0.5) -- node[below, sloped] {} ++(4,0)  -- (s);
  \path [draw, ->] (u1) -- ++(1.5,-0.5) -- node[above, sloped] {} ++(4,0) -- (s);
\end{scope}

% running task
\path [draw, ->, dotted, red] (t00) edge[out=-20, in=190, looseness=1] node[above, sloped] {1} (m0);
\path [draw, ->, dotted, red] (t01) edge[out=0, in=170, looseness=1] node[above, sloped] {2} (m1);

\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
